<mvc:View
    controllerName="project4.controller.View2"
    xmlns:mvc="sap.ui.core.mvc"
    xmlns="sap.m"
    xmlns:form="sap.ui.layout.form"
    xmlns:uxap="sap.uxap"
    height="100%"
>
    <Page showFooter="true">
        <!-- Footer must be in Page, not ObjectPageLayout -->
        <footer>
            <OverflowToolbar>
                <ToolbarSpacer />
                <Button
                    type="Emphasized"
                    text="Submit"
                    press=".onSubmit"
                />
                <Button
                    type="Reject"
                    text="Cancel"
                    press=".onCancel"
                />
            </OverflowToolbar>
        </footer>

        <uxap:ObjectPageLayout
            id="ObjectPageLayout"
            showTitleInHeaderContent="true"
            upperCaseAnchorBar="false"
        >
            <uxap:headerTitle>
                <uxap:ObjectPageDynamicHeaderTitle>
                    <uxap:expandedHeading>
                        <HBox>
                            <Title text="Procurement Request" />
                        </HBox>
                    </uxap:expandedHeading>
                </uxap:ObjectPageDynamicHeaderTitle>
            </uxap:headerTitle>

            <uxap:sections>
                <!-- General Information Section -->
                <uxap:ObjectPageSection title="General Information">
                    <uxap:subSections>
                        <uxap:ObjectPageSubSection>
                            <uxap:blocks>
                                <form:SimpleForm
                                    editable="true"
                                    layout="ResponsiveGridLayout"
                                    labelSpanXL="3"
                                    labelSpanL="3"
                                    labelSpanM="4"
                                    columnsXL="2"
                                    columnsL="2"
                                    columnsM="1"
                                    adjustLabelSpan="false"
                                >
                                    <Label
                                        text="Department"
                                        required="true"
                                    />
                                    <Input
                                        value="{/departmentName}"
                                        showValueHelp="true"
                                        valueHelpRequest=".onDepartmentValueHelp"
                                    />

                                    <Label
                                        text="Supplier"
                                        required="true"
                                    />
                                    <Input
                                        value="{/supplierName}"
                                        showValueHelp="true"
                                        valueHelpRequest=".onSupplierValueHelp"
                                    />

                                    <Label
                                        text="Request Date"
                                        required="true"
                                    />
                                    <DatePicker
                                        value="{/requestDate}"
                                        valueFormat="yyyy-MM-dd"
                                        displayFormat="long"
                                    />

                                    <Label
                                        text="Requested By"
                                        required="true"
                                    />
                                    <Input value="{/requestedBy}" />
                                </form:SimpleForm>
                            </uxap:blocks>
                        </uxap:ObjectPageSubSection>
                    </uxap:subSections>
                </uxap:ObjectPageSection>

                <!-- Product List Section -->
                <uxap:ObjectPageSection title="Product List">
                    <uxap:subSections>
                        <uxap:ObjectPageSubSection>
                            <VBox>
                                <Toolbar>
                                    <Title text="Products" />
                                    <ToolbarSpacer />
                                    <Button
                                        text="Add"
                                        icon="sap-icon://add"
                                        press=".onAddProductRow"
                                    />
                                    <Button
                                        text="Delete"
                                        icon="sap-icon://delete"
                                        press=".onDeleteProductRow"
                                    />
                                </Toolbar>

                                <Table
                                    id="productTable"
                                    mode="MultiSelect"
                                    items="{/ProductList}"
                                >
                                    <columns>
                                        <Column>
                                            <Text text="Product Name" />
                                        </Column>
                                        <Column>
                                            <Text text="Quantity" />
                                        </Column>
                                        <Column>
                                            <Text text="Unit" />
                                        </Column>
                                    </columns>
                                    <items>
                                        <ColumnListItem>
                                            <cells>
                                                <Input
                                                    value="{ProductName}"
                                                    showValueHelp="true"
                                                    valueHelpRequest=".onProductValueHelp"
                                                />
                                                <Input
                                                    value="{Quantity}"
                                                    type="Number"
                                                />
                                                <Input value="{Unit}" />
                                            </cells>
                                        </ColumnListItem>
                                    </items>
                                </Table>
                            </VBox>
                        </uxap:ObjectPageSubSection>
                    </uxap:subSections>
                </uxap:ObjectPageSection>

                <!-- All Procurement Requests Section -->
                <uxap:ObjectPageSection title="All Procurement Requests">
                    <uxap:subSections>
                        <uxap:ObjectPageSubSection>
                            <VBox>
                                <Table
                                    id="allRequestsTable"
                                    inset="false"
                                    mode="SingleSelectMaster"
                                    items="{/ProcurementRequests}"
                                >
                                    <columns>
                                        <Column>
                                            <Text text="Request ID" />
                                        </Column>
                                        <Column>
                                            <Text text="Department" />
                                        </Column>
                                        <Column>
                                            <Text text="Supplier" />
                                        </Column>
                                        <Column>
                                            <Text text="Request Date" />
                                        </Column>
                                        <Column>
                                            <Text text="Status" />
                                        </Column>
                                    </columns>
                                    <items>
                                        <ColumnListItem
                                            type="Navigation"
                                            press=".onRequestSelect"
                                        >
                                            <cells>
                                                <Text text="{cuid}" />
                                                <Text
                                                    text="{department/departmentName}"
                                                />
                                                <Text text="{supplier/name}" />
                                                <Text text="{requestDate}" />
                                                <Text text="{status}" />
                                            </cells>
                                        </ColumnListItem>
                                    </items>
                                </Table>
                            </VBox>
                        </uxap:ObjectPageSubSection>
                    </uxap:subSections>
                </uxap:ObjectPageSection>
            </uxap:sections>
        </uxap:ObjectPageLayout>
    </Page>
</mvc:View>
